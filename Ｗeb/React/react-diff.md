# React Diff Algorithm

React 的 diff 算法是基於樹（Tree）結構的。在列表項的 key 穩定唯一的情況下，算法的時間複雜度為 O(n)，其中 n 是列表項的數量。

## 核心步驟

1. **樹分層比較**：
   - React 會逐層比較新舊虛擬 DOM 樹，從根節點開始，逐層向下進行比較。
   
2. **同層節點比較**：
   - 在同一層內，React 會依次比較每個節點的 key 和類型。如果 key 和類型相同，則認為是同一個節點，只更新屬性；如果不同，則銷毀舊節點，創建新節點。
   
3. **最小化更新**：
   - React 會盡可能只更新發生變化的部分，最小化實際的 DOM 操作，從而提高性能。

### Key 的作用

使用唯一且穩定的 key 有助於 React 高效地進行 diff 操作。key 使得 React 能夠在新舊列表中快速定位相同的元素，從而減少不必要的更新。

## 最小化 DOM 操作：生活範例

### 生活範例：家具佈置

假設你正在佈置一個客廳，而每次你搬入或移出家具，都需要花費很多力氣。你希望能夠最小化搬動家具的次數，讓佈置過程更加高效。

#### 初始狀態
你的客廳現在有以下幾件家具：
1. 沙發
2. 茶几
3. 電視
4. 書架

你想要將它們改成新的佈置：
1. 沙發
2. 茶几
3. 電視
4. 書櫃
5. 地毯

#### 樹分層比較（Tree Comparison）
- **步驟 1**：從根節點（客廳）開始，React 會逐層比較現有的家具和新的佈置。
- **步驟 2**：比較第一層節點（即家具列表），沙發和茶几保持不變，這部分不需要做任何改動。

#### 同層節點比較（Same Level Comparison）
- **步驟 3**：進行同層比較。沙發、茶几和電視都相同，所以只需更新屬性（如位置）。
- **步驟 4**：發現書架和書櫃不同。React 會判定書架需要被移除，並新建一個書櫃。

#### 最小化更新（Minimize Updates）
- **步驟 5**：React 只會處理實際發生變化的部分。它不會重新佈置已經存在且未改變的沙發和茶几，只會搬動書架並加入書櫃和地毯，這樣可以最小化實際的勞動量。

### Key 的作用
假設每個家具都有一個獨特的標籤（key），例如：
- 沙發（key: 1）
- 茶几（key: 2）
- 電視（key: 3）
- 書架（key: 4）

這樣當你改變佈置時，React 可以通過這些唯一且穩定的 key 來快速定位每個家具的位置，確保只處理真正需要變更的項目。

這樣的設計就類似於 React 的 diff 算法，透過最小化 DOM 操作達到高效更新的效果。
